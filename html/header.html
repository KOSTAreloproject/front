<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://unpkg.com/@kfonts/nanum-barun-gothic-yet-hangul-otf/index.css" />
    <link rel="stylesheet" href="../css/search.css" />
    <script src="../js/search.js"></script> 
<style>
  a{
    text-decoration: none;
  }
  li > a {
  color: black;
}
</style>
<script>

   checkLogined();

// --일반회원 로그인상태의 메뉴들 보여주기 함수 START--
function showMenuAtCustomerLogined() {
    $('header>div.top>nav>ul>li.login').hide();
    $('header>div.top>nav>ul>li.join').hide();
    $('header>div.top>nav>ul>li.adminmypage').hide();
    $('header>div.top>nav>ul>li.logout').show();
    $('header>div.top>nav>ul>li.customermypage').show();
    $('header>div.bottom>nav>ul>li.seller').show();
    $('header>div.bottom>nav>ul>li.shop').show();
    $('header>div.bottom>nav>ul>li.styleboard').show();
  }
  //--로그인상태의 메뉴들 보여주기 함수 END--
// --관리자의 로그인상태의 메뉴들 보여주기 함수 START--
function showMenuAtAdminLogined() {
    $('header>div.top>nav>ul>li.login').hide();
    $('header>div.top>nav>ul>li.join').hide();
    $('header>div.bottom>nav>ul>li.seller').hide();
    $('header>div.top>nav>ul>li.customermypage').hide();
    $('header>div.top>nav>ul>li.logout').show();
    $('header>div.top>nav>ul>li.adminmypage').show();
    $('header>div.bottom>nav>ul>li.shop').show();
    $('header>div.bottom>nav>ul>li.styleboard').show();
  }
  //--관리자의 로그인상태의 메뉴들 보여주기 함수 START--

  //--로그아웃상태의 메뉴들 보여주기 함수 START--
  function showMenuAtLogouted() {
    $('header>div.top>nav>ul>li.login').show();
    $('header>div.top>nav>ul>li.join').show();
    $('header>div.top>nav>ul>li.logout').hide();
    $('header>div.top>nav>ul>li.customermypage').hide();
    $('header>div.top>nav>ul>li.adminmypage').hide();
    $('header>div.bottom>nav>ul>li.seller').hide();
    $('header>div.bottom>nav>ul>li.shop').show();
    $('header>div.bottom>nav>ul>li.styleboard').show();
  }
  //--로그아웃상태의 메뉴들 보여주기 함수 END--
let checkType=null;
  //--현재 로그인상태인지 로그아웃상태인가를 요청하는 함수 START--
  function checkLogined() {
    $.ajax({
      url: backUrl + 'member/checklogined',
      xhrFields: {
        withCredentials: true,
      },
      success: function (responseObj) {
        checkType = responseObj;
        if (responseObj == 1) {
          $('#notice_list').attr('href','./noticelist.html'+'?'+checkType)
          showMenuAtAdminLogined();
        }else if (responseObj == 0) {
          $('#notice_list').attr('href','./noticelist.html'+'?'+checkType)
          showMenuAtCustomerLogined();
        }else{
        showMenuAtLogouted();
        } 
      },error:function(){
        showMenuAtLogouted();
      }
    });
  }
  //--로그아웃상태의 메뉴들 보여주기 함수 END--

  $('header>div.top>nav>ul>li.logout').on('click', function () {
    let url = backUrl + 'member/logout';
    $.ajax({
      xhrFields: {
        withCredentials: true, // 클라이언트와 서버가 통신할때 쿠키와 같은 인증 정보 값을 공유하겠다는 설정
      },
      url: url,
      method: 'get',
      success: function () {
        alert('로그아웃 되었습니다.');
        location.href= './index.html'
        showMenuAtLogouted();
      },
      error: function (xhr) {
        alert('오류' + xhr.status);
      },
    });

    
  });

</script>
</head>
  <body>
      <header>
      <div class="top">
        <nav>
        <ul>
          <li class="notice"><a id="notice_list" href="./noticelist.html">공지사항</a></li>
          <li class="customermypage"><a href="./memberprofile.html">마이페이지</a></li>
          <li class="adminmypage"><a href="./admin.html">관리자페이지</a></li>
          <li class="join"><a href="./join.html">회원가입</a></li>
          <li class="login"><a href="./login.html">로그인</a></li>
          <li class="logout">로그아웃</li>
        </ul>
      </div>
      <div class="bottom">
        <div class="img" id="relo"></div>
        <nav>
        <ul>
          <li class="home"><a href="./index.html">HOME</a></li>
          <li class="seller"><a href="./StockAdd3.html">SELL</a></li>
          <li class="shop"><a href="./shoplist.html">SHOP</a></li>
          <li class="styleboard"><a href="./stylelist.html">STYLE</a></li>  
          <li class="search"><img src="../imgs/search.png" class="search"></a></li>  
        </ul>
        </nav>
      </div>
    </header>
      검색창 모달 START
     <div id="search_popup_background">
        <img src="../imgs/search/exit.png">
        <div id="spopup">
          <div id="searchform">
            <img src="../imgs/search/search.png">
            <input type="text" placeholder="검색어를 입력하세요" title="검색창" id="searchtext">
          </div>
          <div class="searchresults">
            <div class="searchresultslist">
              <div class="searchsnum"></div>
              <div class="searchpnum"></div>
              <div class="searchimg"></div>
                <div class="searchpname"></div>
                <div class="searchprice"></div>
                <div class="searchpenddate"></div>
                <div style="clear:both;"></div>
                <hr id="searchhr">
              </div>
            </div>
            <hr id="hr1">
          <div id="category">
            <h3>카테고리</h3>
            <div id="category_wrap">
              <div id="top"><img src =../imgs/search/top.jpg>상의</div>
              <div id="bottom"><img src =../imgs/search/bottom.jpg>하의</div>
              <div id="shoes"><img src =../imgs/search/shoes.jpg>신발</div>
            </div>
          </div>
          <hr id="hr2">
          <div class="mywish">
            <h3>나의 관심상품</h3>
            <div style="clear:both;"></div>
              <div class="wish">
                <div class="wishlist">
                  <div class="swpnum"></div>
                  <div class="swimg"></div>
                  <div class="swname"></div>
                  <div class="swprice"></div>
                  <div class="swenddate"></div>
                  <div style="clear:both;"></div>
                  <hr id="hr3">
                </div>
            </div>
          </div>
           <div style="clear:both;"></div>
           <div class="myzmoreview"><button>더보기</button></div>
        </div>
      </div> 
      <!-- 검색창 모달 END -->
    </div>
  </body>
  <script>
    checkIntervalLogined();
function checkIntervalLogined() {
    window.setInterval(checkLogined, 1000 * 60 * 10);
  }
  // -- 로고 click시 메인 페이지로 이동 start --
  $(document).on('click', $('div#relo.img'), function (e) {
    if($(e.target).is('#relo')){
          location.href = './index.html';
        }
  });
  // -- 로고 click시 메인 페이지로 이동 end --
  </script>
</html>